<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>媒体列表</title>

    {include file='layout/top' /}

</head>

<!--TIPS-->
<!--You may remove all ID or Class names which contain "demo-", they are only used for demonstration. -->
<body>
<div id="container" class="effect aside-float aside-bright mainnav-lg">

    <!--NAVBAR-->
    <!--===================================================-->
    {include file='layout/header' /}
    <!--===================================================-->
    <!--END NAVBAR-->

    <div class="boxed">

        <!--CONTENT CONTAINER-->
        <!--===================================================-->
        <div id="content-container">

            <!--Page Title-->
            <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
            <div id="page-title">
                <!-- <h1 class="page-header text-overflow">Data Tables</h1>

                <div class="searchbox">
                    <div class="input-group custom-search-form">
                        <input type="text" class="form-control" placeholder="Search..">
                        <span class="input-group-btn">
                            <button class="text-muted" type="button"><i class="demo-pli-magnifi-glass"></i></button>
                        </span>
                    </div>
                </div> -->
            </div>
            <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
            <!--End page title-->


            <!--Breadcrumb-->
            <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
            <ol class="breadcrumb">
                <li><a href="{:url('Admin/Index/index')}">首页</a></li>
                <li>媒体管理</li>
                <li class="active">媒体管理</li>
            </ol>
            <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
            <!--End breadcrumb-->


            <!--Page content-->
            <!--===================================================-->
            <div id="page-content">
               
                <form class="form-inline" method="post">
                    <div class="form-group">
                        媒体名称:
                        <input type="text" name="title" placeholder="" id="demo-inline-inputmail" class="form-control">
                    </div>
                    &nbsp&nbsp&nbsp&nbsp
                    <div class="form-group">
                        收录类型:
                        <select name="in_type_id" id="demo-inline-inputpass1" class="form-control">
                            <option value="">全部</option>
                           {foreach name="souinfo" id="v"}
                            <option value="{$v['id']}">{$v['title']}</option>
                            {/foreach}
                        </select>
                    </div>
                    &nbsp&nbsp&nbsp&nbsp
                    <div class="form-group">
                        频道类型:
                        <select name="ch_type_id" id="demo-inline-inputpass2" class="form-control">
                            <option value="">全部</option>
                            {foreach name="pinfo" id="v"}
                            <option value="{$v['id']}">{$v['title']}</option>
                            {/foreach}
                           
                        </select>
                    </div>
                      &nbsp&nbsp&nbsp&nbsp
                      <div class="form-group">
                        媒体类型:
                        <select name="media_type_id" id="demo-inline-inputpass3" class="form-control">
                            <option value="">全部</option>
                            {foreach name="mtinfo" id="v"}
                            <option value="{$v['id']}">{$v['title']}</option>
                            {/foreach}
                            
                        </select>
                    </div>
                      &nbsp&nbsp&nbsp&nbsp
                      <div class="form-group">
                        媒体来源:
                        <select name="media_from_id" id="demo-inline-inputpass4" class="form-control">
                            <option value="">全部</option>
                            {foreach name="mfinfo" id="v"}
                            <option value="{$v['id']}">{$v['title']}</option>
                            {/foreach}
                            
                        </select>
                    </div>
                       &nbsp&nbsp&nbsp&nbsp
                      <div class="form-group">
                        门户类型:
                        <select name="gate_id" id="demo-inline-inputpass5" class="form-control">
                            <option value="">全部</option>
                            {foreach name="minfo" id="v"}
                           <option value="{$v['id']}">{$v['title']}</option>
                           {/foreach}
                            
                        </select>
                    </div>
                      &nbsp&nbsp&nbsp&nbsp
                      <div class="form-group">
                       地区:
                        <select name="province" id="demo-inline-inputpass" class="form-control">
                            <option value="">全部</option>
                           {foreach name="province" id="v"}
                           <option value="{$v['id']}">{$v['name']}</option>
                           {/foreach}
                        </select>
                    </div>
                      &nbsp&nbsp&nbsp&nbsp
                    <input type="submit" value="搜索"  class="btn btn-primary">
                    <span onclick="daochu()" class="btn btn-primary">导出数据</span>
                <script>
                    function daochu(){
                        var title = $("input[name=title]").val();//alert(title);
                        //var username = $("input[name=user]").val();//alert(username);
                        var in_type_id = $('#demo-inline-inputpass1 option:selected').val(); //alert(in_type_id)       //收录类型                      
                        var ch_type_id = $('#demo-inline-inputpass2 option:selected').val(); //alert(ch_type_id)       //频道类型                      
                        var media_type_id = $('#demo-inline-inputpass3 option:selected').val(); //alert(media_type_id)       //媒体类型                      
                        var media_from_id = $('#demo-inline-inputpass4 option:selected').val(); //alert(media_from_id)       //媒体来源类型                      
                        var gate_id = $('#demo-inline-inputpass5 option:selected').val(); //alert(gate_id)       //门户类型                      
                        var province = $('#demo-inline-inputpass option:selected').val(); //alert(province)       //省                      
                        window.location.href="<?php echo url('Media/export');?>"+'?title='+title+'&in_type_id='+in_type_id+'&ch_type_id='+ch_type_id+'&media_type_id='+media_type_id+'&media_from_id='+media_from_id+'&gate_id='+gate_id+'&prov='+province;

                    }                                       
                </script>
                  
                </form>
                <div class="panel">
                    
                    <div class="panel-body">
                        <table id="demo-dt-basic" class="table table-striped table-bordered" cellspacing="0"
                               width="100%">
                            <thead>
                            <tr>
                                <th>媒体名称</th>
                                <th>收录类型</th>
                              <!--   <th>收录效果</th> -->
                                <th>媒体类型</th>
                                <th>媒体来源</th>
                                <th>频道类型</th>
                                <th>地区</th>
                                <th>门户类型</th>
                                <th>成本价</th>
                                <th>指导价</th>
                                <th>案例</th>
                                <th>备注</th>
                             
                                <th class="min-tablet">操作</th>
                            </tr>
                            </thead>
                            <tbody>
                            {foreach name="info" id="v"}
                            <tr>

                                <td>{$v['title']}</td>
                                <td>{$v['in_type_id']}</td>
                              <!--   <td>{$v['in_effect_id']}</td> -->
                                <td>{$v['media_type_id']}</td>
                                <td>{$v['media_from_id']}</td>
                                <td>{$v['ch_type_id']}</td>
                                <td>{$v['prov']}</td>
                                <td>{$v['gate_id']}</td>
                                <td>{$v['cost_price']}</td>
                                <td><a href="javascript:;" mediaId="{$v['id']}" media_price="{$v['guide_price']}"  onclick="edit(this)"><button class="btn btn-primary">{$v['guide_price']}</button></a></td>
                                <td>{$v['case']}</td>
                                <td>{$v['remark']}</td>
                                <td>
                                    <a  href="{:url('Admin/media/edit_media',array('id'=>$v['id']))}" "><button class="btn btn-primary">修改</button></a>
                                    <a href="javascript:if(confirm('确定删除？'))location='{:url('Admin/media/delete',array('id'=>$v['id']))}'"><button class="btn btn-danger">删除</button></a>
                                </td>
                            </tr>
                            {/foreach}
                            </tbody>
                        </table>
                        {$info->render()}
                    </div>
                </div>
            </div>
        </div>
        {include file="layout/left" /}

    </div>

    {include file="layout/footer" /}

    <button class="scroll-top btn">
        <i class="pci-chevron chevron-up"></i>
    </button>
</div>
<!-- 修改菜单模态框开始 -->
<div class="modal fade" id="thinkright-edit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    修改媒体价格
                </h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" action="{:url('Admin/media/edit_price')}" method="post">
                <input type="hidden" name="id" >
                    <div class="panel-body">
                        <div class="form-group">
                            <label class="col-sm-3 control-label" for="demo-hor-inputemail">修改前的价格</label>
                            <div class="col-sm-9">                             
                                <input type="text" id="demo-hor-inputemail" class="form-control" name="cancel_price"
                                       required="required">
                            </div>
                        </div>
                         <div class="form-group">
                            <label class="col-sm-3 control-label" for="demo-hor-inputemail">修改后的价格</label>
                            <div class="col-sm-9">                             
                                <input type="text" id="demo-hor-inputemail" class="form-control" name="price"
                                       required="required">
                            </div>
                        </div>
                       <!--   <div class="form-group">
                            <label class="col-sm-3 control-label" for="demo-hor-inputemail">媒体名</label>
                            <div class="col-sm-9">                             
                                <input type="text" id="demo-hor-inputemail" class="form-control" name="media"
                                       required="required">
                            </div>
                        </div>
 -->
                    </div>
                    <div class="panel-footer text-right">
                        <button class="btn btn-success" type="submit">修改</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- 修改菜单模态框结束 -->


<script type="text/javascript">

    // 添加子菜单
    function add_child(obj) {
        var ruleId = $(obj).attr('ruleId');
        $("input[name='pid']").val(ruleId);
        $("input[name='title']").val('');
        $("input[name='name']").val('');
        $("input:radio[name='show']").val('');
        $('#thinkright-add').modal('show');
    }

    // 修改指导价菜单
    function edit(obj) {
        var mediaId = $(obj).attr('mediaId');//媒体id    //alert(mediaId);
        var mediaprice = $(obj).attr('media_price');//媒体id   //alert(mediaprice);

        $("input[name='cancel_price']").val(mediaprice);
        $("input[name='id']").val(mediaId);
    //     $("input:radio[name='show']").val(ruleshow);
        $('#thinkright-edit').modal('show');
    }
</script>
</body>
</html>
